<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Star Rail</title>
    <link rel="stylesheet" href="../static/dist/css/output.css" />
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script defer src="/_vercel/insights/script.js"></script>
  </head>
  <body>
    <div class="flex absolute top-0 right-0 z-10">
      <div class="cursor-pointer w-16 h-16">
        <a href="javascript:history.back()">
          <img src="{{asset_url}}/icon/sign/TeamIcon.png" alt="Team Icon" />
        </a>
      </div>
      <div class="cursor-pointer w-16 h-16">
        <img
          src="{{asset_url}}icon/sign/SettingsImageIcon.png"
          alt="Save Icon"
          onclick="save()"
        />
      </div>
    </div>
    <div class="min-h-screen bg-gray-800 text-white">
      <div class="h-auto flex justify-center items-center">
        <div class="overflow-x-auto">
          <div class="flex flex-col justify-center h-screen">
            <div
              class="flex BG w-[1600px] justify-center p-4 rounded-lg"
              id="showcase"
            >
              <div class="flex flex-col justify-center w-1/4">
                <div class="flex items-center justify-between">
                  <span class="text-4xl">
                    {{data.characters[chara].name}}
                  </span>
                  <img
                    src="{{asset_url + data.characters[chara].element.icon}}"
                    alt="{{data.characters[chara].element.name}}"
                    class="w-12 h-12"
                  />
                </div>
                <div class="flex items-center space-x-2">
                  <img
                    src="{{asset_url + data.characters[chara].path.icon}}"
                    alt="Path"
                    class="w-12 h-12"
                  />
                  <span class="text-xl"
                    >{{data.characters[chara].path.name}}</span
                  >
                </div>
                <div class="flex flex-col text-center">
                  <span class="text-xl">
                    Eidolon {{data.characters[chara].rank}}
                  </span>
                  <span class="text-2xl">
                    Lv. {{data.characters[chara].level}} /
                    {{data.characters[chara].promotion * 10 + 20}}
                  </span>
                </div>
                <div class="flex flex-col text-lg">
                  {% for stat in data2.characters[chara].property %}
                  <div class="flex justify-between">
                    <div class="flex items-center gap-2">
                      <img
                        src="{{asset_url + stat.icon}}"
                        alt="{{stat.name}}"
                        class="w-8 h-8"
                      />

                      <span>{{stat.name}} </span>
                    </div>
                    {% if stat.addition is none %}
                    <span class="text-gray-300">{{stat.base}}</span>
                    {% else %}
                    <span class="text-gray-300">
                      {{stat.base|int + stat.addition|int}}
                    </span>
                    {% endif %}
                  </div>
                  {% endfor %}
                  <div class="text-center">
                    <hr />
                    <span class="text-2xl">Lightcone</span>
                    <hr />
                  </div>
                </div>
                <div class="flex flex-col items-center">
                  <span class="text-xl">
                    {{data.characters[chara].light_cone.name}}
                  </span>
                  <img
                    src="{{asset_url + data.characters[chara].light_cone.preview}}"
                    alt="Lightcone"
                    class="w-48 h-auto"
                  />
                  <span class="text-lg">
                    Superimposition {{data.characters[chara].light_cone.rank}}
                  </span>
                  <span class="text-lg">
                    Lv. {{data.characters[chara].light_cone.level}} /
                    {{data.characters[chara].light_cone.promotion * 10 + 20}}
                  </span>
                </div>
              </div>
              <div
                class="flex flex-col justify-center items-center text-center w-1/3"
              >
                <img
                  src="{{asset_url + data.characters[chara].portrait}}"
                  alt="{{data.characters[chara].name}}"
                  class="h-auto min-w-0"
                />
                <div class="w-1/2">
                  <hr />
                  <span class="text-2xl">Skills</span>
                  <hr />
                </div>
                <div class="flex items-center">
                  {% for skill in data2.characters[chara].skill %}
                  <div class="flex flex-col items-center m-1">
                    <img
                      src="{{asset_url + skill.icon}}"
                      alt="{{skill.name}}"
                      class="w-12 h-12"
                    />
                    <span class="text-lg">Lv. {{skill.level}}</span>
                    <span class="text-lg">{{skill.type}}</span>
                  </div>
                  {% endfor %}
                </div>
                <div class="flex flex-col w-1/2 space-y-1">
                  <hr />
                  <span class="text-xl">{{data.player.nickname}}</span>
                  <span class="text-xl">UID {{data.player.uid}}</span>
                </div>
              </div>
              <div
                class="flex flex-col justify-center items-center w-5/12 space-y-2"
              >
                <div class="grid grid-cols-2 grid-rows-3 gap-2">
                  {% for relic in data.characters[chara].relics %}
                  <div
                    class="rounded-lg relative flex items-center space-x-4 p-2"
                    style="background-color: rgba(0, 0, 0, 0.3)"
                  >
                    <div class="flex flex-col items-center text-center">
                      <img
                        src="{{asset_url + relic.icon}}"
                        alt="{{relic.name}}"
                        class="w-32 h-auto"
                      />
                      <img
                        src="{{asset_url}}icon/deco/Star{{relic.rarity}}.png"
                        alt="{{relic.rarity}}"
                        class="w-24 h-auto"
                      />
                      <span
                        class="badge text-gray-300 badge-outline bg-gray-900 w-1/2 rounded"
                        >+{{relic.level}}</span
                      >
                    </div>
                    <div class="w-full">
                      <div
                        class="flex flex-row justify-between items-center text-yellow-400"
                      >
                        <div class="flex items-center">
                          <img
                            src="{{asset_url + relic.main_affix.icon}}"
                            alt="{{relic.main_affix.name}}"
                            class="w-10 h-10"
                          />
                          <span class="text-left text-lg pr-2"
                            >{{relic.main_affix.name}}</span
                          >
                        </div>

                        <span class="text-right text-lg">
                          {{relic.main_affix.display}}
                        </span>
                      </div>
                      <div class="flex flex-col">
                        <div class="flex flex-col">
                          {% for substat in relic.sub_affix %}
                          <div
                            class="flex flex-row justify-between items-center"
                          >
                            <div class="flex items-center">
                              <img
                                src="{{asset_url + substat.icon}}"
                                alt="{{substat.name}}"
                                class="w-8 h-8"
                              />
                              <span>{{substat.name}}</span>
                            </div>
                            <span class="text-right">{{substat.display}}</span>
                          </div>
                          {% endfor %}
                        </div>
                      </div>
                    </div>
                  </div>
                  {% endfor %}
                </div>
                <div class="flex flex-col text-center w-1/2">
                  <hr />
                  <span class="text-2xl">Relic Set</span>
                  <hr />
                  {% for set in data2.characters[chara].relic_set %}
                  <div class="flex justify-between px-2">
                    <span class="font-medium text-left">{{set.name}}</span>
                    <span class="text-gray-300 font-medium text-right">
                      {{set.desc}}
                    </span>
                  </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function save() {
        html2canvas(document.querySelector("#showcase"), {
          useCORS: true,
          backgroundColor: null,
        }).then((canvas) => {
          canvas.toBlob(function (blob) {
            window.saveAs(blob, "showcase.png");
          });
        });
      }
    </script>
  </body>
</html>
